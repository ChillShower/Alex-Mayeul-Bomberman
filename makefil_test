CC = gcc
CFLAGS = -Wall -Iinclude
SRC_DIR = source
INCLUDE_DIR = include
MAIN_DIR = main
OBJ_DIR = obj
BIN_DIR = bin

# List of source files to compile
SRC_FILES = $(wildcard $(SRC_DIR)/*.c)
MAIN_SRC_FILE = $(wildcard $(MAIN_DIR)/main.c)
# List of object files to generate
OBJ_FILES = $(patsubst $(SRC_DIR)/%.c,$(OBJ_DIR)/%.o,$(SRC_FILES))

# Main targets
all: $(BIN_DIR)/main.x

# Rule to compile source files into object files
$(OBJ_DIR)/%.o: $(SRC_DIR)/%.c
	$(CC) $(CFLAGS) -c $< -o $@

# Rule to compile main source file into object file
$(OBJ_DIR)/main.o: $(MAIN_SRC_FILE)
	$(CC) $(CFLAGS) -c $< $(OBJ_FILES) -o $@

# Rule to link main object file into main executable
$(BIN_DIR)/main.x: $(OBJ_DIR)/main.o
	$(CC) $(CFLAGS) $(OBJ_DIR)/main.o -o $@

# Clean target to remove object files and executables
clean:
	rm -f $(OBJ_DIR)/*.o $(BIN_DIR)/main